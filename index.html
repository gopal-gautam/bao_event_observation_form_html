<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">
        <title>Add Event observation</title>
        <!-- Bootstrap core CSS -->
        <!-- Custom styles for this template -->
        <link href="style.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
        <link href="https://bootswatch.com/4/materia/bootstrap.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    </head>
    <body>
        <div class="container border">
            <div class="row">
                <div class="col-md-4">
                    <h3>Event Observation</h3> 
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <ul class="list-group fa-ul"> 
                            <li class="list-group-item" href="#">
                                <span class="list-group-item-header" data-toggle="collapse" data-target="#act_obs-container">Activity Vs Observation</span>
                                <div class="container collapse show" id="act_obs-container">
                                    <form id="act-obs-form">
                                        <table class="table" id="activity-table"> 
                                            <thead> 
                                                <tr> 
                                                    <th>#</th> 
                                                    <th>Activity</th> 
                                                    <th>Observation</th> 
                                                    <th>Actions</th> 
                                                </tr>                                                 
                                            </thead>                                             
                                            <tbody> 
                                                <tr> 
                                                    <td>
                                                        <div class="form-group"> </div>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            1
                                                    </td>                                                     
                                                    <td>
                                                        <input type="text" class="form-control" id="activity_1" required>
                                                    </td>
                                                    <td>
                                                        <input type="text" class="form-control" id="observation_1" required>
                                                    </td>                                                     
                                                    <td class="text-center">
                                                        <button type="button" class="btn btn-danger" id="remove-activity">
                                                            <i class="fa fa-remove"> Remove</i>
                                                        </button>
                                                    </td>                                                     
                                                </tr>
                                                <tr>
                                                    <td colspan="4" class="success text-right">
                                                        <a href="#" data-toggle="tooltip" data-placement="bottom" title="Add new row" data-trigger="hover" id="add-activity-row"><i role="button" class="fa fa-plus-circle fa-3x text-success"></i></a>
                                                    </td>
                                                </tr>                                                 
                                            </tbody>
                                        </table>
                                    </form>
                                </div>
                            </li>
                            <li class="list-group-item" href="#">
                                <span class="list-group-item-header" data-toggle="collapse" data-target="#expectation-container">Expectation</span>
                                <div class="container collapse show" id="expectation-container">
                                    <textarea class="form-control" rows="3" id="textarea-expectation"></textarea>
                                </div>
                            </li>
                            <li class="list-group-item" href="#">
                                <span class="list-group-item-header" data-toggle="collapse" data-target="#problem-container">Problem</span>
                                <div class="container collapse show" id="problem-container">
                                    <textarea class="form-control" rows="3" id="textarea-problem"></textarea>
                                </div>
                            </li>
                            <li class="list-group-item" href="#">
                                <span class="list-group-item-header" data-toggle="collapse" data-target="#lession-container">Lession</span>
                                <div class="container collapse show" id="lession-container">
                                    <textarea class="form-control" rows="3" id="textarea-lession"></textarea>
                                </div>
                            </li>
                            <li class="list-group-item" href="#">
                                <span class="list-group-item-header" data-toggle="collapse" data-target="#followup-container">Follow up</span>
                                <div class="container collapse show" id="followup-container">
                                    <textarea class="form-control" rows="3" id="textarea-followup"></textarea>
                                </div>
                            </li>
                            <li class="list-group-item" href="#">
                                <span class="list-group-item-header" data-toggle="collapse" data-target="#aob-container">AOB</span>
                                <div class="container collapse show" id="aob-container">
                                    <textarea class="form-control" rows="3" id="textarea-aob"></textarea>
                                </div>
                            </li>
                        </ul>                         
                    </div>
                </div>
                <div class="row text-right">
                    <div class="text-right col-md-12">
                        <div class="pull-right" style="margin-top: 20px;">
                            <div class="btn-toolbar" role="toolbar"> 
                                <div class="btn-group"> 
                                    <button type="button" class="btn btn-primary" id="save-btn">Save</button>
                                </div>                                 
                                <div class="btn-group"> 
                                    <button type="button" class="btn btn-default" id="cancel-btn">cancel</button>                                     
                                </div>
                            </div>
                        </div>                         
                    </div>
                </div>
            </div>
        </div>
        <!-- Bootstrap core JavaScript
    ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
        <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
        <script src="assets/js/ie10-viewport-bug-workaround.js"></script>
        <script src="assets/js/tether.min.js"></script>
        <script>
            // click handle to add a new row when plus button is clicked in activity observation table
            var $activityTableBody = $("#activity-table > tbody");            
            $("#add-activity-row").on('click', function() {                
                var indx = $activityTableBody.find('tr').length;;
                var act_input_html = "<input type='text' class='form-control' id='activity_"+indx+"' required />";
                var obs_input_html = "<input type='text' class='form-control' id='observation_"+indx+"' required />";
                var control_column = '<button type="button" class="btn btn-danger"  id="remove-activity"><i class="fa fa-remove"> Remove</i></button>';
                var newrow = "<tr><td>"+ indx +"</td><td>"+act_input_html+"</td><td>"+obs_input_html+"</td><td class='text-center'>"+control_column+"</td></tr>";

                $(newrow).insertBefore($(this).parents('tr'));
            });

            // posting the information
            function getVal(jqSelectorId) {
                return $('#'+jqSelectorId).val();
            }

            $("#save-btn").on('click', function(event) {
                var act_obs_datas = [];
                var actRowsLength = $activityTableBody.find('tr').length;
                for(var i=1; i<actRowsLength; i++)
                {
                    var act = getVal('activity_'+i);
                    var obs = getVal('observation_'+i);
                    if(act.trim() || obs.trim())
                    {
                        act_obs_datas.push({activity: act, observation: obs});
                    }
                }

                var post_data = {
                    acitivites: act_obs_datas,
                    expectation: getVal('textarea-expectation'),
                    problem: getVal('textarea-problem'),
                    lession: getVal('textarea-lession'),
                    followup: getVal('textarea-followup'),
                    aob: getVal('textarea-aob'),
                }
                console.log(post_data);
            });

            $("body").on("click", '#remove-activity', function(event) {
                var $self = $(this);
                var $currentActRow = $self.parents('tr');
                $currentActRow.remove();
            })

            // $("activity-table").children('input').each(function(index, ele) {
                
            // })
        </script>
    </body>
</html>
